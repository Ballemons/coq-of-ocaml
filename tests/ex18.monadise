1 Reference (r, Type (Z/1))

3
((),
  Value (non_rec, plus_one, [ A ], [ (x, A) ], Some Monad ([ r/0 ], Type (Z/1)))
    =
    Match
      (?, Variable (?, x/0),
        [
          (Any,
            Bind
              (?,
                Bind
                  (?,
                    Apply
                      (4,
                        Variable
                          (?,
                            read_r/0),
                        Tuple (?)),
                    Some x,
                    Return
                      (?,
                        Apply
                          (4,
                            Variable
                              (4,
                                Z.add/1),
                            Variable
                              (?,
                                x/0)))),
                Some x,
                Return
                  (?,
                    Apply
                      (?, Variable (?, x/0),
                        Constant
                          (4,
                            Int(1))))))
        ]))

6 Reference (s, Type (string/1))

8
((),
  Value
    (non_rec, fail, [ A; B ], [ (x, B) ], Some Monad ([ s/0; Failure/1 ], A)) =
    Match
      (?, Variable (?, x/0),
        [
          (Any,
            Bind
              (?,
                Lift
                  (?, [ s/0 ], [ s/0; Failure/1 ],
                    Apply
                      (8,
                        Variable
                          (?,
                            read_s/0),
                        Tuple (?))),
                Some x,
                Lift
                  (?, [ Failure/1 ], [ s/0; Failure/1 ],
                    Apply
                      (8,
                        Variable
                          (8,
                            failwith/1),
                        Variable
                          (?,
                            x/0)))))
        ]))
