1 Reference (r, Type (Z/0))

3
(Value
  (non_rec, @.,
    [
      ((plus_one, [ A ], [ (x, A) ], Some Type (Z/0)),
        Match
          ((?, Effect ([ r/0 ], .)), Variable ((?, Effect ([ ], .)), x/0),
            [
              (Any,
                Apply
                  ((4,
                    Effect
                      ([
                        r/0
                      ],
                        .)),
                    Variable
                      ((4,
                        Effect
                          ([
                          ],
                            .)),
                        Z.add/0),
                    [
                      Apply
                        ((4,
                          Effect
                            ([
                              r/0
                            ],
                              .)),
                          Variable
                            ((?,
                              Effect
                                ([
                                ],
                                  .
                                    -[
                                      r/0
                                    ]->
                                    .)),
                              read_r/0),
                          [
                            Tuple
                              ((?,
                                Effect
                                  ([
                                  ],
                                    .)))
                          ]);
                      Constant
                        ((4,
                          Effect
                            ([
                            ],
                              .)),
                          Int(1))
                    ]))
            ]))
    ]))

6 Reference (s, Type (string/0))

8
(Value
  (non_rec, @.,
    [
      ((fail, [ A; B ], [ (x, A) ], Some B),
        Match
          ((?, Effect ([ OCaml.Failure/0; s/0 ], .)),
            Variable ((?, Effect ([ ], .)), x/0),
            [
              (Any,
                Apply
                  ((8,
                    Effect
                      ([
                        OCaml.Failure/0;
                        s/0
                      ],
                        .)),
                    Variable
                      ((8,
                        Effect
                          ([
                          ],
                            .
                              -[
                                OCaml.Failure/0
                              ]->
                              .)),
                        OCaml.Pervasives.failwith/0),
                    [
                      Apply
                        ((8,
                          Effect
                            ([
                              s/0
                            ],
                              .)),
                          Variable
                            ((?,
                              Effect
                                ([
                                ],
                                  .
                                    -[
                                      s/0
                                    ]->
                                    .)),
                              read_s/0),
                          [
                            Tuple
                              ((?,
                                Effect
                                  ([
                                  ],
                                    .)))
                          ])
                    ]))
            ]))
    ]))

10
(Value
  (non_rec, @.,
    [
      ((reset, [ A ], [ (x, A) ], Some Type (unit/0)),
        Match
          ((?, Effect ([ r/0 ], .)), Variable ((?, Effect ([ ], .)), x/0),
            [
              (Any,
                Apply
                  ((11,
                    Effect
                      ([
                        r/0
                      ],
                        .)),
                    Variable
                      ((?,
                        Effect
                          ([
                          ],
                            .
                              -[
                                r/0
                              ]->
                              .)),
                        write_r/0),
                    [
                      Constant
                        ((11,
                          Effect
                            ([
                            ],
                              .)),
                          Int(0))
                    ]))
            ]))
    ]))

13
(Value
  (non_rec, @.,
    [
      ((incr, [ A ], [ (x, A) ], Some Type (unit/0)),
        Match
          ((?, Effect ([ r/0 ], .)), Variable ((?, Effect ([ ], .)), x/0),
            [
              (Any,
                Apply
                  ((14,
                    Effect
                      ([
                        r/0
                      ],
                        .)),
                    Variable
                      ((?,
                        Effect
                          ([
                          ],
                            .
                              -[
                                r/0
                              ]->
                              .)),
                        write_r/0),
                    [
                      Apply
                        ((14,
                          Effect
                            ([
                              r/0
                            ],
                              .)),
                          Variable
                            ((14,
                              Effect
                                ([
                                ],
                                  .)),
                              Z.add/0),
                          [
                            Apply
                              ((14,
                                Effect
                                  ([
                                    r/0
                                  ],
                                    .)),
                                Variable
                                  ((?,
                                    Effect
                                      ([
                                      ],
                                        .
                                          -[
                                            r/0
                                          ]->
                                          .)),
                                    read_r/0),
                                [
                                  Tuple
                                    ((?,
                                      Effect
                                        ([
                                        ],
                                          .)))
                                ]);
                            Constant
                              ((14,
                                Effect
                                  ([
                                  ],
                                    .)),
                                Int(1))
                          ])
                    ]))
            ]))
    ]))
