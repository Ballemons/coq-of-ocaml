Inductive 'set':
  ([ ], [ ('Empty', [ ]); ('Node', [ Type ('set'); Type ('Z'); Type ('set') ]) ])

((),
  Value (non_rec, 'empty', [ ], [ ], Some Type ('set')) =
    Constructor ((), 'Empty'))

((),
  Value
    (rec, 'member_rec', [ ],
      [ ('counter', Type ('nat')); ('x', Type ('Z')); ('s', Type ('set')) ],
      Some Monad ([ 'NonTermination' ], Type ('bool'))) =
    Match
      ((), Variable ((), 'counter'),
        [
          (Nat(0),
            Apply
              ((), Variable ((), 'not_terminated'),
                Variable ((), 'tt')));
          (Constructor ('S', 'counter'),
            Match
              ((), Variable ((), 's'),
                [
                  (Constructor ('Empty'),
                    Return
                      ((),
                        Constructor
                          ((),
                            'false')));
                  (Constructor ('Node', 's1', 'y', 's2'),
                    IfThenElse
                      ((),
                        Apply
                          ((),
                            Apply
                              ((),
                                Variable
                                  ((),
                                    'Z.ltb'),
                                Variable
                                  ((),
                                    'x')),
                            Variable
                              ((),
                                'y')),
                        Apply
                          ((),
                            Apply
                              ((),
                                Apply
                                  ((),
                                    Variable
                                      ((),
                                        'member_rec'),
                                    Variable
                                      ((),
                                        'counter')),
                                Variable
                                  ((),
                                    'x')),
                            Variable
                              ((),
                                's1')),
                        IfThenElse
                          ((),
                            Apply
                              ((),
                                Apply
                                  ((),
                                    Variable
                                      ((),
                                        'Z.ltb'),
                                    Variable
                                      ((),
                                        'y')),
                                Variable
                                  ((),
                                    'x')),
                            Apply
                              ((),
                                Apply
                                  ((),
                                    Apply
                                      ((),
                                        Variable
                                          ((),
                                            'member_rec'),
                                        Variable
                                          ((),
                                            'counter')),
                                    Variable
                                      ((),
                                        'x')),
                                Variable
                                  ((),
                                    's2')),
                            Return
                              ((),
                                Constructor
                                  ((),
                                    'true')))))
                ]))
        ]))

((),
  Value
    (non_rec, 'member', [ ], [ ('x', Type ('Z')); ('s', Type ('set')) ],
      Some Monad ([ 'Counter'; 'NonTermination' ], Type ('bool'))) =
    Bind
      ((),
        Lift
          ((), [ 'Counter' ], [ 'Counter'; 'NonTermination' ],
            Apply ((), Variable ((), 'read_counter'), Variable ((), 'tt'))),
        Some 'counter',
        Lift
          ((), [ 'NonTermination' ], [ 'Counter'; 'NonTermination' ],
            Apply
              ((),
                Apply
                  ((),
                    Apply
                      ((), Variable ((), 'member_rec'), Variable ((), 'counter')),
                    Variable ((), 'x')), Variable ((), 's')))))

((),
  Value
    (rec, 'insert_rec', [ ],
      [ ('counter', Type ('nat')); ('x', Type ('Z')); ('s', Type ('set')) ],
      Some Monad ([ 'NonTermination' ], Type ('set'))) =
    Match
      ((), Variable ((), 'counter'),
        [
          (Nat(0),
            Apply
              ((), Variable ((), 'not_terminated'),
                Variable ((), 'tt')));
          (Constructor ('S', 'counter'),
            Match
              ((), Variable ((), 's'),
                [
                  (Constructor ('Empty'),
                    Return
                      ((),
                        Constructor
                          ((),
                            'Node',
                            Constructor
                              ((),
                                'Empty'),
                            Variable
                              ((),
                                'x'),
                            Constructor
                              ((),
                                'Empty'))));
                  (Constructor ('Node', 's1', 'y', 's2'),
                    IfThenElse
                      ((),
                        Apply
                          ((),
                            Apply
                              ((),
                                Variable
                                  ((),
                                    'Z.ltb'),
                                Variable
                                  ((),
                                    'x')),
                            Variable
                              ((),
                                'y')),
                        Bind
                          ((),
                            Apply
                              ((),
                                Apply
                                  ((),
                                    Apply
                                      ((),
                                        Variable
                                          ((),
                                            'insert_rec'),
                                        Variable
                                          ((),
                                            'counter')),
                                    Variable
                                      ((),
                                        'x')),
                                Variable
                                  ((),
                                    's1')),
                            Some
                              'x',
                            Return
                              ((),
                                Constructor
                                  ((),
                                    'Node',
                                    Variable
                                      ((),
                                        'x'),
                                    Variable
                                      ((),
                                        'y'),
                                    Variable
                                      ((),
                                        's2')))),
                        IfThenElse
                          ((),
                            Apply
                              ((),
                                Apply
                                  ((),
                                    Variable
                                      ((),
                                        'Z.ltb'),
                                    Variable
                                      ((),
                                        'y')),
                                Variable
                                  ((),
                                    'x')),
                            Bind
                              ((),
                                Apply
                                  ((),
                                    Apply
                                      ((),
                                        Apply
                                          ((),
                                            Variable
                                              ((),
                                                'insert_rec'),
                                            Variable
                                              ((),
                                                'counter')),
                                        Variable
                                          ((),
                                            'x')),
                                    Variable
                                      ((),
                                        's2')),
                                Some
                                  'x',
                                Return
                                  ((),
                                    Constructor
                                      ((),
                                        'Node',
                                        Variable
                                          ((),
                                            's1'),
                                        Variable
                                          ((),
                                            'y'),
                                        Variable
                                          ((),
                                            'x')))),
                            Return
                              ((),
                                Variable
                                  ((),
                                    's')))))
                ]))
        ]))

((),
  Value
    (non_rec, 'insert', [ ], [ ('x', Type ('Z')); ('s', Type ('set')) ],
      Some Monad ([ 'Counter'; 'NonTermination' ], Type ('set'))) =
    Bind
      ((),
        Lift
          ((), [ 'Counter' ], [ 'Counter'; 'NonTermination' ],
            Apply ((), Variable ((), 'read_counter'), Variable ((), 'tt'))),
        Some 'counter',
        Lift
          ((), [ 'NonTermination' ], [ 'Counter'; 'NonTermination' ],
            Apply
              ((),
                Apply
                  ((),
                    Apply
                      ((), Variable ((), 'insert_rec'), Variable ((), 'counter')),
                    Variable ((), 'x')), Variable ((), 's')))))
