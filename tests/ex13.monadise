3
(Value
  (non_rec, @.,
    [
      ((tail, [ A ], [ (l, Type (list/0, A)) ],
        Some Monad ([ OCaml.Failure/0 ], Type (list/0, A))),
        Match
          (4, Variable (4, l/0),
            [
              (Constructor (cons/0, Any, xs),
                Return (?, Variable (5, xs/0)));
              (Constructor ([]/0),
                Apply
                  (6,
                    Variable
                      (6,
                        OCaml.Pervasives.failwith/0),
                    [
                      Constant
                        (6,
                          String("Cannot take the tail of an empty list."))
                    ]))
            ]))
    ]))

8
(Value
  (rec, @.,
    [
      ((print_list_rec, [ ],
        [ (counter, Type (nat/0)); (x, Type (list/0, Type (string/0))) ],
        Some Monad ([ IO/0; NonTermination/0 ], Type (unit/0))),
        Match
          (?, Variable (?, counter/0),
            [
              (Constructor (O/0),
                Lift
                  (?,
                    [
                      NonTermination/0
                    ],
                    [
                      IO/0;
                      NonTermination/0
                    ],
                    Apply
                      (?,
                        Variable
                          (?,
                            not_terminated/0),
                        [
                          Tuple
                            (?)
                        ])));
              (Constructor (S/0, counter),
                Match
                  (?, Variable (?, x/0),
                    [
                      (Constructor
                        ([]/0),
                        Return
                          (?,
                            Constructor
                              (9,
                                tt/0)));
                      (Constructor
                        (cons/0,
                          x,
                          xs),
                        Bind
                          (?,
                            Lift
                              (?,
                                [
                                  IO/0
                                ],
                                [
                                  IO/0;
                                  NonTermination/0
                                ],
                                Apply
                                  (11,
                                    Variable
                                      (11,
                                        OCaml.Pervasives.print_string/0),
                                    [
                                      Variable
                                        (11,
                                          x/0)
                                    ])),
                            None,
                            Apply
                              (12,
                                Apply
                                  (?,
                                    Variable
                                      (?,
                                        print_list_rec/0),
                                    [
                                      Variable
                                        (?,
                                          counter/0)
                                    ]),
                                [
                                  Variable
                                    (12,
                                      xs/0)
                                ])))
                    ]))
            ]))
    ]))

8
(Value
  (non_rec, @.,
    [
      ((print_list, [ ], [ (x, Type (list/0, Type (string/0))) ],
        Some Monad ([ Counter/0; IO/0; NonTermination/0 ], Type (unit/0))),
        Bind
          (?,
            Lift
              (?, [ Counter/0 ], [ Counter/0; IO/0; NonTermination/0 ],
                Apply (?, Variable (?, read_counter/0), [ Tuple (?) ])),
            Some x_1,
            Lift
              (?, [ IO/0; NonTermination/0 ],
                [ Counter/0; IO/0; NonTermination/0 ],
                Apply
                  (?, Variable (?, print_list_rec/0),
                    [ Variable (?, x_1/0); Variable (?, x/0) ]))))
    ]))

14
(Value
  (non_rec, @.,
    [
      ((f, [ ], [ ],
        Some
          (Type (list/0, Type (string/0)) ->
            Monad ([ Counter/0; IO/0; NonTermination/0 ], Type (unit/0)))),
        Variable (14, print_list/0))
    ]))

16
(Value
  (non_rec, @.,
    [
      ((x, [ A ], [ (z, A) ],
        Some
          Monad
            ([ Counter/0; IO/0; NonTermination/0; OCaml.Failure/0 ],
              Type (unit/0))),
        Bind
          (?,
            Lift
              (?, [ OCaml.Failure/0 ],
                [ Counter/0; IO/0; NonTermination/0; OCaml.Failure/0 ],
                Apply
                  (16, Variable (16, tail/0),
                    [
                      Constructor
                        (16,
                          cons/0,
                          Constant
                            (16,
                              String("Stop")),
                          Constructor
                            (16,
                              cons/0,
                              Constant
                                (16,
                                  String("Hello")),
                              Constructor
                                (16,
                                  cons/0,
                                  Constant
                                    (16,
                                      String(" ")),
                                  Constructor
                                    (16,
                                      cons/0,
                                      Constant
                                        (16,
                                          String("world")),
                                      Constructor
                                        (16,
                                          []/0)))))
                    ])), Some x,
            Lift
              (?, [ Counter/0; IO/0; NonTermination/0 ],
                [ Counter/0; IO/0; NonTermination/0; OCaml.Failure/0 ],
                Apply (16, Variable (16, f/0), [ Variable (?, x/0) ]))))
    ]))
