(.,
  Value (non_rec, 'l', [ ], [ ], Some Type ('list', Type ('Z'))) =
    Let (?, Effect ([ 'Counter'; 'NonTermination' ], .))
      (rec, 'map_rec', [ 'A'; 'B' ],
        [
          ('counter', Type ('nat'));
          ('f', ('B' -> 'A'));
          ('match_var_0', Type ('list', 'B'))
        ], Some Type ('list', 'A')) =
      Match
        ((?, Effect ([ 'NonTermination' ], .)),
          Variable ((?, Effect ([ ], .)), 'counter'),
          [
            (Nat(0),
              Apply
                ((?, Effect ([ 'NonTermination' ], .)),
                  Variable
                    ((?,
                      Effect
                        ([ ],
                          .
                            -[
                              'NonTermination'
                            ]->
                            .)),
                      'not_terminated'),
                  Variable ((?, Effect ([ ], .)), 'tt')));
            (Constructor ('S', 'counter'),
              Match
                ((?, Effect ([ 'NonTermination' ], .)),
                  Variable
                    ((?, Effect ([ ], .)),
                      'match_var_0'),
                  [
                    (Constructor ('[]'),
                      Constructor
                        ((?,
                          Effect
                            ([
                            ],
                              .)),
                          '[]'));
                    (Constructor
                      ('cons',
                        'x',
                        'xs'),
                      Constructor
                        ((?,
                          Effect
                            ([
                              'NonTermination'
                            ],
                              .)),
                          'cons',
                          Apply
                            ((?,
                              Effect
                                ([
                                ],
                                  .)),
                              Variable
                                ((?,
                                  Effect
                                    ([
                                    ],
                                      .)),
                                  'f'),
                              Variable
                                ((?,
                                  Effect
                                    ([
                                    ],
                                      .)),
                                  'x')),
                          Apply
                            ((?,
                              Effect
                                ([
                                  'NonTermination'
                                ],
                                  .)),
                              Apply
                                ((?,
                                  Effect
                                    ([
                                    ],
                                      .
                                        -[
                                          'NonTermination'
                                        ]->
                                        .)),
                                  Apply
                                    ((?,
                                      Effect
                                        ([
                                        ],
                                          .
                                            ->
                                            .
                                              -[
                                                'NonTermination'
                                              ]->
                                              .)),
                                      Variable
                                        ((?,
                                          Effect
                                            ([
                                            ],
                                              .
                                                ->
                                                .
                                                  ->
                                                  .
                                                    -[
                                                      'NonTermination'
                                                    ]->
                                                    .)),
                                          'map_rec'),
                                      Variable
                                        ((?,
                                          Effect
                                            ([
                                            ],
                                              .)),
                                          'counter')),
                                  Variable
                                    ((?,
                                      Effect
                                        ([
                                        ],
                                          .)),
                                      'f')),
                              Variable
                                ((?,
                                  Effect
                                    ([
                                    ],
                                      .)),
                                  'xs'))))
                  ]))
          ]) in
    Let (?, Effect ([ 'Counter'; 'NonTermination' ], .))
      (non_rec, 'map', [ 'A'; 'B' ],
        [ ('f', ('B' -> 'A')); ('match_var_0', Type ('list', 'B')) ],
        Some Type ('list', 'A')) =
      Let (?, Effect ([ 'Counter'; 'NonTermination' ], .))
        (non_rec, 'counter', [ ], [ ], None) =
        Apply
          ((?, Effect ([ 'Counter' ], .)),
            Variable ((?, Effect ([ ], . -[ 'Counter' ]-> .)), 'read_counter'),
            Variable ((?, Effect ([ ], .)), 'tt')) in
      Apply
        ((?, Effect ([ 'NonTermination' ], .)),
          Apply
            ((?, Effect ([ ], . -[ 'NonTermination' ]-> .)),
              Apply
                ((?, Effect ([ ], . -> . -[ 'NonTermination' ]-> .)),
                  Variable
                    ((?, Effect ([ ], . -> . -> . -[ 'NonTermination' ]-> .)),
                      'map_rec'), Variable ((?, Effect ([ ], .)), 'counter')),
              Variable ((?, Effect ([ ], .)), 'f')),
          Variable ((?, Effect ([ ], .)), 'match_var_0')) in
    Let (?, Effect ([ 'Counter'; 'NonTermination' ], .))
      (rec, 'loop_rec', [ 'A' ], [ ('counter', Type ('nat')); ('x', 'A') ],
        Some 'A') =
      Match
        ((?, Effect ([ 'NonTermination' ], .)),
          Variable ((?, Effect ([ ], .)), 'counter'),
          [
            (Nat(0),
              Apply
                ((?, Effect ([ 'NonTermination' ], .)),
                  Variable
                    ((?,
                      Effect
                        ([ ],
                          .
                            -[
                              'NonTermination'
                            ]->
                            .)),
                      'not_terminated'),
                  Variable ((?, Effect ([ ], .)), 'tt')));
            (Constructor ('S', 'counter'), Variable ((?, Effect ([ ], .)), 'x'))
          ]) in
    Let (?, Effect ([ 'Counter'; 'NonTermination' ], .))
      (non_rec, 'loop', [ 'A' ], [ ('x', 'A') ], Some 'A') =
      Let (?, Effect ([ 'Counter'; 'NonTermination' ], .))
        (non_rec, 'counter', [ ], [ ], None) =
        Apply
          ((?, Effect ([ 'Counter' ], .)),
            Variable ((?, Effect ([ ], . -[ 'Counter' ]-> .)), 'read_counter'),
            Variable ((?, Effect ([ ], .)), 'tt')) in
      Apply
        ((?, Effect ([ 'NonTermination' ], .)),
          Apply
            ((?, Effect ([ ], . -[ 'NonTermination' ]-> .)),
              Variable
                ((?, Effect ([ ], . -> . -[ 'NonTermination' ]-> .)), 'loop_rec'),
              Variable ((?, Effect ([ ], .)), 'counter')),
          Variable ((?, Effect ([ ], .)), 'x')) in
    Apply
      ((?, Effect ([ 'Counter'; 'NonTermination' ], .)),
        Apply
          ((?, Effect ([ ], . -[ 'Counter'; 'NonTermination' ]-> .)),
            Variable
              ((?, Effect ([ ], . -> . -[ 'Counter'; 'NonTermination' ]-> .)),
                'map'),
            Function
              ((?, Effect ([ ], . -> .)), 'n',
                Apply
                  ((?, Effect ([ ], .)),
                    Apply
                      ((?, Effect ([ ], .)),
                        Variable ((?, Effect ([ ], .)), 'Z.add'),
                        Variable ((?, Effect ([ ], .)), 'n')),
                    Constant ((?, Effect ([ ], .)), Int(1))))),
        Constructor
          ((?, Effect ([ ], .)), 'cons',
            Constant ((?, Effect ([ ], .)), Int(5)),
            Constructor
              ((?, Effect ([ ], .)), 'cons',
                Constant ((?, Effect ([ ], .)), Int(7)),
                Constructor
                  ((?, Effect ([ ], .)), 'cons',
                    Constant ((?, Effect ([ ], .)), Int(8)),
                    Constructor ((?, Effect ([ ], .)), '[]'))))))
