<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Tezos.Fees_storage</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Tezos.Fees_storage</h1>

<div class="code">
</div>

<div class="doc">
Generated by coq-of-ocaml 
</div>
<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">OCaml.OCaml</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">type_scope</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Tezos.Environment.html#"><span class="id" title="library">Tezos.Environment</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Environment.Notations</span>.<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="Tezos.Constants_repr.html#"><span class="id" title="library">Tezos.Constants_repr</span></a>.<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="Tezos.Constants_storage.html#"><span class="id" title="library">Tezos.Constants_storage</span></a>.<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="Tezos.Contract_repr.html#"><span class="id" title="library">Tezos.Contract_repr</span></a>.<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="Tezos.Contract_storage.html#"><span class="id" title="library">Tezos.Contract_storage</span></a>.<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="Tezos.Raw_context.html#"><span class="id" title="library">Tezos.Raw_context</span></a>.<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="Tezos.Tez_repr.html#"><span class="id" title="library">Tezos.Tez_repr</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;❌&nbsp;Structure&nbsp;item&nbsp;`typext`&nbsp;not&nbsp;handled.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;type_extension&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;❌&nbsp;Structure&nbsp;item&nbsp;`typext`&nbsp;not&nbsp;handled.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;type_extension&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;❌&nbsp;Structure&nbsp;item&nbsp;`typext`&nbsp;not&nbsp;handled.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;type_extension&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;❌&nbsp;Top-level&nbsp;evaluations&nbsp;are&nbsp;ignored&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;top_level_evaluation&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="origination_burn"><span class="id" title="definition">origination_burn</span></a> (<span class="id" title="var">c</span> : <a class="idref" href="Tezos.Raw_context.html#context"><span class="id" title="definition">Raw_context.context</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Tezos.Environment.html#Lwt.t"><span class="id" title="definition">Lwt.t</span></a> (<a class="idref" href="Tezos.Environment.html#Error_monad.tzresult"><span class="id" title="definition">Error_monad.tzresult</span></a> (<a class="idref" href="Tezos.Raw_context.html#t"><span class="id" title="definition">Raw_context.t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="Tezos.Tez_repr.html#t"><span class="id" title="definition">Tez_repr.t</span></a>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">origination_size</span> := <a class="idref" href="Tezos.Constants_storage.html#origination_size"><span class="id" title="definition">Constants_storage.origination_size</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cost_per_byte</span> := <a class="idref" href="Tezos.Constants_storage.html#cost_per_byte"><span class="id" title="definition">Constants_storage.cost_per_byte</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">let</span></a><a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">=?</span></a> <span class="id" title="var">to_be_paid</span> <a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Lwt.__return"><span class="id" title="definition">Lwt.__return</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Tezos.Tez_repr.html#op_starquestion"><span class="id" title="definition">Tez_repr.op_starquestion</span></a> <a class="idref" href="Tezos.Fees_storage.html#cost_per_byte"><span class="id" title="variable">cost_per_byte</span></a> (<a class="idref" href="Tezos.Environment.html#Int64.of_int"><span class="id" title="axiom">Int64.of_int</span></a> <a class="idref" href="Tezos.Fees_storage.html#origination_size"><span class="id" title="variable">origination_size</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Error_monad.__return"><span class="id" title="definition">Error_monad.__return</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">((</span></a><a class="idref" href="Tezos.Raw_context.html#update_allocated_contracts_count"><span class="id" title="definition">Raw_context.update_allocated_contracts_count</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">),</span></a> <a class="idref" href="Tezos.Fees_storage.html#to_be_paid"><span class="id" title="variable">to_be_paid</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="record_paid_storage_space"><span class="id" title="definition">record_paid_storage_space</span></a><br/>
&nbsp;&nbsp;(<span class="id" title="var">c</span> : <a class="idref" href="Tezos.Raw_context.html#t"><span class="id" title="definition">Raw_context.t</span></a>) (<span class="id" title="var">contract</span> : <a class="idref" href="Tezos.Contract_repr.html#t"><span class="id" title="inductive">Contract_repr.t</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Tezos.Environment.html#Lwt.t"><span class="id" title="definition">Lwt.t</span></a> (<a class="idref" href="Tezos.Environment.html#Error_monad.tzresult"><span class="id" title="definition">Error_monad.tzresult</span></a> (<a class="idref" href="Tezos.Raw_context.html#t"><span class="id" title="definition">Raw_context.t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="Tezos.Environment.html#Z.t"><span class="id" title="definition">Z.t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="Tezos.Environment.html#Z.t"><span class="id" title="definition">Z.t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="Tezos.Tez_repr.html#t"><span class="id" title="definition">Tez_repr.t</span></a>)) :=<br/>
&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">let</span></a><a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">=?</span></a> <span class="id" title="var">size</span> <a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">:=</span></a> <a class="idref" href="Tezos.Contract_storage.html#used_storage_space"><span class="id" title="definition">Contract_storage.used_storage_space</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Tezos.Fees_storage.html#contract"><span class="id" title="variable">contract</span></a> <a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#0bda090fdf5de4b8721bd60dca0fe8ed"><span class="id" title="notation">let</span></a><a class="idref" href="Tezos.Environment.html#0bda090fdf5de4b8721bd60dca0fe8ed"><span class="id" title="notation">=?</span></a> <a class="idref" href="Tezos.Environment.html#0bda090fdf5de4b8721bd60dca0fe8ed"><span class="id" title="notation">'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">to_be_paid</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">c</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="Tezos.Environment.html#0bda090fdf5de4b8721bd60dca0fe8ed"><span class="id" title="notation">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Contract_storage.html#set_paid_storage_space_and_return_fees_to_pay"><span class="id" title="definition">Contract_storage.set_paid_storage_space_and_return_fees_to_pay</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Tezos.Fees_storage.html#contract"><span class="id" title="variable">contract</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Fees_storage.html#size"><span class="id" title="variable">size</span></a> <a class="idref" href="Tezos.Environment.html#0bda090fdf5de4b8721bd60dca0fe8ed"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">c</span> := <a class="idref" href="Tezos.Raw_context.html#update_storage_space_to_pay"><span class="id" title="definition">Raw_context.update_storage_space_to_pay</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Tezos.Fees_storage.html#to_be_paid"><span class="id" title="variable">to_be_paid</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cost_per_byte</span> := <a class="idref" href="Tezos.Constants_storage.html#cost_per_byte"><span class="id" title="definition">Constants_storage.cost_per_byte</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">let</span></a><a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">=?</span></a> <span class="id" title="var">to_burn</span> <a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Lwt.__return"><span class="id" title="definition">Lwt.__return</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Tezos.Tez_repr.html#op_starquestion"><span class="id" title="definition">Tez_repr.op_starquestion</span></a> <a class="idref" href="Tezos.Fees_storage.html#cost_per_byte"><span class="id" title="variable">cost_per_byte</span></a> (<a class="idref" href="Tezos.Environment.html#Z.to_int64"><span class="id" title="axiom">Z.to_int64</span></a> <a class="idref" href="Tezos.Fees_storage.html#to_be_paid"><span class="id" title="variable">to_be_paid</span></a>)) <a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Error_monad.__return"><span class="id" title="definition">Error_monad.__return</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Tezos.Fees_storage.html#size"><span class="id" title="variable">size</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Tezos.Fees_storage.html#to_be_paid"><span class="id" title="variable">to_be_paid</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Tezos.Fees_storage.html#to_burn"><span class="id" title="variable">to_burn</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="burn_storage_fees"><span class="id" title="definition">burn_storage_fees</span></a><br/>
&nbsp;&nbsp;(<span class="id" title="var">c</span> : <a class="idref" href="Tezos.Raw_context.html#context"><span class="id" title="definition">Raw_context.context</span></a>) (<span class="id" title="var">storage_limit</span> : <a class="idref" href="Tezos.Environment.html#Z.t"><span class="id" title="definition">Z.t</span></a>) (<span class="id" title="var">payer</span> : <a class="idref" href="Tezos.Contract_repr.html#t"><span class="id" title="inductive">Contract_repr.t</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Tezos.Environment.html#Lwt.t"><span class="id" title="definition">Lwt.t</span></a> (<a class="idref" href="Tezos.Environment.html#Error_monad.tzresult"><span class="id" title="definition">Error_monad.tzresult</span></a> <a class="idref" href="Tezos.Raw_context.html#t"><span class="id" title="definition">Raw_context.t</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">origination_size</span> := <a class="idref" href="Tezos.Constants_storage.html#origination_size"><span class="id" title="definition">Constants_storage.origination_size</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">c</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">storage_space_to_pay</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">allocated_contracts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Raw_context.html#clear_storage_space_to_pay"><span class="id" title="definition">Raw_context.clear_storage_space_to_pay</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">storage_space_for_allocated_contracts</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Z.mul"><span class="id" title="definition">Z.mul</span></a> (<a class="idref" href="Tezos.Environment.html#Z.of_int"><span class="id" title="axiom">Z.of_int</span></a> <span class="id" title="var">allocated_contracts</span>) (<a class="idref" href="Tezos.Environment.html#Z.of_int"><span class="id" title="axiom">Z.of_int</span></a> <a class="idref" href="Tezos.Fees_storage.html#origination_size"><span class="id" title="variable">origination_size</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">consumed</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Z.add"><span class="id" title="definition">Z.add</span></a> <span class="id" title="var">storage_space_to_pay</span> <a class="idref" href="Tezos.Fees_storage.html#storage_space_for_allocated_contracts"><span class="id" title="variable">storage_space_for_allocated_contracts</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">remaining</span> := <a class="idref" href="Tezos.Environment.html#Z.sub"><span class="id" title="definition">Z.sub</span></a> <a class="idref" href="Tezos.Fees_storage.html#storage_limit"><span class="id" title="variable">storage_limit</span></a> <a class="idref" href="Tezos.Fees_storage.html#consumed"><span class="id" title="variable">consumed</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="notation">(|</span><a class="idref" href="Tezos.Environment.html#Compare.Z"><span class="id" title="axiom">Compare.Z</span></a><span class="id" title="notation">|)</span>.(<a class="idref" href="Tezos.Environment.html#Compare.S.op_lt"><span class="id" title="projection">Compare.S.op_lt</span></a>) <a class="idref" href="Tezos.Fees_storage.html#remaining"><span class="id" title="variable">remaining</span></a> <a class="idref" href="Tezos.Environment.html#Z.zero"><span class="id" title="definition">Z.zero</span></a> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Error_monad.fail"><span class="id" title="axiom">Error_monad.fail</span></a> <span class="id" title="axiom">extensible_type_value</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cost_per_byte</span> := <a class="idref" href="Tezos.Constants_storage.html#cost_per_byte"><span class="id" title="definition">Constants_storage.cost_per_byte</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">let</span></a><a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">=?</span></a> <span class="id" title="var">to_burn</span> <a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Lwt.__return"><span class="id" title="definition">Lwt.__return</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Tezos.Tez_repr.html#op_starquestion"><span class="id" title="definition">Tez_repr.op_starquestion</span></a> <a class="idref" href="Tezos.Fees_storage.html#cost_per_byte"><span class="id" title="variable">cost_per_byte</span></a> (<a class="idref" href="Tezos.Environment.html#Z.to_int64"><span class="id" title="axiom">Z.to_int64</span></a> <a class="idref" href="Tezos.Fees_storage.html#consumed"><span class="id" title="variable">consumed</span></a>)) <a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Tezos.Tez_repr.html#op_eq"><span class="id" title="definition">Tez_repr.op_eq</span></a> <a class="idref" href="Tezos.Fees_storage.html#to_burn"><span class="id" title="variable">to_burn</span></a> <a class="idref" href="Tezos.Tez_repr.html#zero"><span class="id" title="definition">Tez_repr.zero</span></a> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Error_monad.__return"><span class="id" title="definition">Error_monad.__return</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">let</span></a><a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">=?</span></a> <span class="id" title="var">c</span> <a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Error_monad.trace"><span class="id" title="axiom">Error_monad.trace</span></a> <span class="id" title="axiom">extensible_type_value</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Tezos.Environment.html#0bda090fdf5de4b8721bd60dca0fe8ed"><span class="id" title="notation">let</span></a><a class="idref" href="Tezos.Environment.html#0bda090fdf5de4b8721bd60dca0fe8ed"><span class="id" title="notation">=?</span></a> <a class="idref" href="Tezos.Environment.html#0bda090fdf5de4b8721bd60dca0fe8ed"><span class="id" title="notation">'</span></a><span class="id" title="var">_</span> <a class="idref" href="Tezos.Environment.html#0bda090fdf5de4b8721bd60dca0fe8ed"><span class="id" title="notation">:=</span></a> <a class="idref" href="Tezos.Contract_storage.html#must_exist"><span class="id" title="definition">Contract_storage.must_exist</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Tezos.Fees_storage.html#payer"><span class="id" title="variable">payer</span></a> <a class="idref" href="Tezos.Environment.html#0bda090fdf5de4b8721bd60dca0fe8ed"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Contract_storage.html#spend"><span class="id" title="definition">Contract_storage.spend</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Tezos.Fees_storage.html#payer"><span class="id" title="variable">payer</span></a> <a class="idref" href="Tezos.Fees_storage.html#to_burn"><span class="id" title="variable">to_burn</span></a>) <a class="idref" href="Tezos.Environment.html#fe7ed8135c3e89d56eff82d8ee27a32f"><span class="id" title="notation">in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Error_monad.__return"><span class="id" title="definition">Error_monad.__return</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="check_storage_limit"><span class="id" title="definition">check_storage_limit</span></a><br/>
&nbsp;&nbsp;(<span class="id" title="var">c</span> : <a class="idref" href="Tezos.Raw_context.html#context"><span class="id" title="definition">Raw_context.context</span></a>) (<span class="id" title="var">storage_limit</span> : <span class="id" title="notation">(|</span><a class="idref" href="Tezos.Environment.html#Compare.Z"><span class="id" title="axiom">Compare.Z</span></a><span class="id" title="notation">|)</span>.(<a class="idref" href="Tezos.Environment.html#Compare.S.t"><span class="id" title="projection">Compare.S.t</span></a>))<br/>
&nbsp;&nbsp;: <a class="idref" href="Tezos.Environment.html#Error_monad.tzresult"><span class="id" title="definition">Error_monad.tzresult</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Pervasives.op_pipepipe"><span class="id" title="axiom">Pervasives.op_pipepipe</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(|</span><a class="idref" href="Tezos.Environment.html#Compare.Z"><span class="id" title="axiom">Compare.Z</span></a><span class="id" title="notation">|)</span>.(<a class="idref" href="Tezos.Environment.html#Compare.S.op_gt"><span class="id" title="projection">Compare.S.op_gt</span></a>) <a class="idref" href="Tezos.Fees_storage.html#storage_limit"><span class="id" title="variable">storage_limit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Tezos.Raw_context.html#constants"><span class="id" title="definition">Raw_context.constants</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a>).(<a class="idref" href="Tezos.Constants_repr.html#parametric.hard_storage_limit_per_operation"><span class="id" title="projection">Constants_repr.parametric.hard_storage_limit_per_operation</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(|</span><a class="idref" href="Tezos.Environment.html#Compare.Z"><span class="id" title="axiom">Compare.Z</span></a><span class="id" title="notation">|)</span>.(<a class="idref" href="Tezos.Environment.html#Compare.S.op_lt"><span class="id" title="projection">Compare.S.op_lt</span></a>) <a class="idref" href="Tezos.Fees_storage.html#storage_limit"><span class="id" title="variable">storage_limit</span></a> <a class="idref" href="Tezos.Environment.html#Z.zero"><span class="id" title="definition">Z.zero</span></a>) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Error_monad.__error_value"><span class="id" title="axiom">Error_monad.__error_value</span></a> <span class="id" title="axiom">extensible_type_value</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Tezos.Environment.html#Error_monad.ok"><span class="id" title="definition">Error_monad.ok</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.0/stdlib//Coq.Init.Datatypes.html#tt"><span class="id" title="constructor">tt</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="start_counting_storage_fees"><span class="id" title="definition">start_counting_storage_fees</span></a> (<span class="id" title="var">c</span> : <a class="idref" href="Tezos.Raw_context.html#t"><span class="id" title="definition">Raw_context.t</span></a>) : <a class="idref" href="Tezos.Raw_context.html#t"><span class="id" title="definition">Raw_context.t</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Tezos.Raw_context.html#init_storage_space_to_pay"><span class="id" title="definition">Raw_context.init_storage_space_to_pay</span></a> <a class="idref" href="Tezos.Fees_storage.html#c"><span class="id" title="variable">c</span></a>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>